(()=>{"use strict";var e={327:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EUVElement=void 0;class n{constructor(e){if(!e)throw new Error("element is null");this.domElement=e,this.tagName=e.tagName,this.tempDisplay=e.style.display,this.innerHTML=e.innerHTML,this.nodeTextContentMap=new Map;for(const t of e.childNodes)t.nodeType===Node.TEXT_NODE&&t.textContent&&this.nodeTextContentMap.set(t,t.textContent);this.parentElement=null,this.children=new Array(this.domElement.children.length);for(let e=0;e<this.domElement.children.length;e++){const t=this.domElement.children[e];this.children[e]=new n(t)}}getNodeTextContent(e){return this.nodeTextContentMap.get(e)}}t.EUVElement=n},132:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EUV=void 0;const o=n(327),i=n(746);let r=null;t.EUV=class{constructor(e={mounted:()=>{},data:{},computed:{},methods:{},directives:{}}){if("function"!=typeof e.mounted)throw new Error("mounted must be a function");this.mounted=e.mounted;const t=this;this.init=!1,this.$refs={},this.computed=e.computed,this.methods={},this.directiveMap=new Map;for(let t in e.directives){if(e.directives[t].mounted&&"function"!=typeof e.directives[t].mounted)throw new Error(`directives[${t}].mounted is not a function`);this.directiveMap.set({name:t,multi:!1},e.directives[t])}this.dataElementMapping=new Map;const n=this.dataElementMapping;for(const t in e.data)this.dataElementMapping.set(t,new Set);const i=(e,s)=>{const a={};for(const t in s){const n=void 0===e?t:e;Array.isArray(s[t])?(a[t]=i(n,s[t]),a[t][Symbol.iterator]=function*(){for(let e=0;e<Object.keys(a[t]).length;e++)yield a[t][e]}):"object"==typeof s[t]?a[t]=i(n,s[t]):a[t]=s[t]}return((e,i)=>{if(!i)throw new Error("被代理对象不能为空值");return new Proxy(i,{get(t,i){var s;if(r&&r instanceof o.EUVElement){const t=void 0===e?i:e;null===(s=n.get(t))||void 0===s||s.add(r)}return t[i]},set(o,i,r){const s=o[i];if(s===r)return!1;o[i]=r,console.log(`[${i.toString()}]set`,s,"=>",r);const a=void 0===e?i:e,d=n.get(a);if(!d)return!0;for(const e of d)t.renderEUVElement(e);return!0}})})(e,a)};this.data=i(void 0,e.data);for(const t in e.methods)Object.defineProperty(this.methods,t,{get:()=>e.methods[t],set(n){if("function"!=typeof n)throw new Error("method must be a function");e.methods[t]=n}});this.addDirective("show",{updated(e,n,o){const i=t.runExpressionCode(o,n.value);e.style.display=i?o.tempDisplay?o.tempDisplay:"block":"none"}}),this.addDirective({name:"bind:",aliasName:":",multi:!0},{mounted(e,n,o){if(void 0===t.data[n.value]||null===t.data[n.value])return;const i=n.name.split(":")[1],r=t.runExpressionCode(o,n.value);e.setAttribute(i,r)}});const s=new MutationObserver((e=>{for(const t of e){const e=t.target,n="e-model:"+t.attributeName,o=e.getAttribute(n);if(!o)continue;const i=e.getAttribute(t.attributeName);this.runExpressionCode(null,o,"set",i)}}));this.addDirective({name:"model:",multi:!0},{mounted(e,n,o){const i=t.runExpressionCode(o,n.value),r=n.name.split(":")[1];e.setAttribute(r,i),e[r]=i,s.observe(e,{attributes:!0});const a=()=>{const o=e[r];t.runExpressionCode(null,n.value,"set",o)};e.addEventListener("change",a),e.addEventListener("input",a)},updated(e,n,o){const i=t.runExpressionCode(o,n.value);if(null==i)return;const r=n.name.split(":")[1];e.setAttribute(r,i),e[r]=i}}),this.addDirective({name:"e-on:",aliasName:"@",multi:!0},{mounted(e,n){let o=n.name.split(":")[1];if(o||(o=n.name.split("@")[1]),!o)return;const i=n.value;e.addEventListener(o,(e=>{t.methods[i].bind(t)(e)}))}}),e.elementSelector&&this.mount(e.elementSelector)}mount(e){if(!e||"string"!=typeof e)return;if(this.mountedElement=document.querySelector(e),!this.mountedElement)throw new Error("elementSelector is not valid");this.mountedElement.setAttribute("data-e-app","");const t=new o.EUVElement(this.mountedElement),n=e=>{for(const t of e.children)t.parentElement=e,n(t)};n(t);const i=e=>{for(const t of e.children)this.renderEUVElement(t),i(t)};i(t),this.init=!0;const r=e=>{for(const t of e.children){r(t);const e=t.domElement,n=e.getAttribute("ref");n&&(this.$refs[n]=new Proxy(e,{get:(e,t)=>e[t],set:(e,t,n)=>{e[t]=n;if(null!=e.getAttribute(t)){const o="e-model:"+t,i=e.getAttribute(o);i&&(this.runExpressionCode(null,i,"set",n),e.setAttribute(t,n))}return!0}}),e.removeAttribute("ref"))}};r(t);const s=e=>{for(const t of e.children){const e=t.domElement;for(const[n,o]of this.directiveMap)if(o.mounted)if(n.multi)for(const i of e.attributes){if(void 0===i.value||null===i.value)continue;if(n.aliasName&&!i.name.startsWith(n.name)&&!i.name.startsWith(n.aliasName))continue;if(!n.aliasName&&!i.name.startsWith(n.name))continue;const[r,s]=[i.name.split(n.name)[1],n.aliasName?i.name.split(n.aliasName)[1]:void 0];(r||s)&&o.mounted(e,i,t)}else{console.log(n,e);const[i,r]=[e.getAttributeNode(n.name),n.aliasName?e.getAttributeNode(n.aliasName):void 0];i&&void 0!==i.value&&null!==i.value?o.mounted(e,i,t):r&&void 0!==r.value&&null!==r.value&&o.mounted(e,r,t)}s(t)}};s(t),this.mounted&&this.mounted.bind(this)()}addDirective(e,t){if(!e)throw new Error("name must be a string or object");if("string"!=typeof e){if(!e.name)throw new Error(`name is ${e.name}`);e.name.startsWith("e-")||(e.name="e-"+e.name),void 0!==e.multi&&null!==e.multi||(e.multi=!1),this.directiveMap.set(e,t)}else{e.startsWith("e-")||(e="e-"+e);const n={name:e,multi:!1};this.directiveMap.set(n,t)}}runExpressionCode(e,t,n="get",o=void 0){r=e;const s=(e=>{const t=e=>{const t=e=>{const n=e.indexOf("[");if(-1===n)return;const o=e.substring(n+1);if(!o.includes("]"))throw new Error(`"${e}"格式错误，缺少“]”`);let i=1;for(let e=0;e<o.length;e++){const n=o[e];if("["===n?i++:"]"===n&&i--,0===i){let n=[o.substring(0,e)];const i=n[0].indexOf("[");if(-1!==i){const e=t(n[0]);n.push(...e),n[0]=n[0].substring(0,i)}const r=o.substring(e+1),s=t(r);return s?[...new Set(n.concat(s))]:[...new Set(n)]}}if(0!==i)throw new Error(`"${e}"格式错误，缺少${i}个“]”`)};return t(e)},n=e=>{if(e.startsWith("."))throw new Error(`"${e}"格式错误，不能以“.”开头`);if(isNaN(parseInt(e))){const[t,...n]=e.split(".");if(void 0!==this.data[t]&&null!==this.data[t])return"this.data."+e;if(this.computed[t])return`this.computed.${t}.bind(this)()`+(n&&0!==n.length?`.${n.join(".")}`:"")}return e};if(!e)return"";let o=e.replace(/\s/g,"");const r=o.split(/\=|\+|\-|\*|\/|\%|\<|\>|\<|\>|\&|\^|\||\?|\:/g);for(let e of r){const r=new RegExp((0,i.escapeRegExp)(e),"g");if(e.includes("[")){const i=t(e);for(const t of i){const o=n(t),i=new RegExp(t,"g");e=e.replace(i,o)}const s=e.substring(0,e.indexOf("[")),a=n(s),d=e.replace(s,a);o=o.replace(r,d);continue}const s=n(e);o=o.replace(r,s)}return o})(t),a=new Function(`\n            ${"get"===n||"GET"===n?`return (${s});`:"set"===n||"SET"===n?`(${s}) = \`${o}\`;`:""}\n        `).bind(this)();return r=null,"object"==typeof a?JSON.stringify(a):a}renderEUVElement(e){if(!e)return;if(!(e instanceof o.EUVElement))return void console.error("render element is not EUVElement",e);const t=e.domElement;for(const n of t.childNodes){if(n.nodeType!==Node.TEXT_NODE)continue;const t=e.getNodeTextContent(n);t&&(n.textContent=t)}((e,t)=>{function n(e){const n=e.textContent;if(!n)return;const o=function*(e){let t,n,o=e;for(;-1!==(t=o.indexOf("{{"))&&(n=o.indexOf("}}",t),-1!==n);){const e=o.substring(t+2,n).trim(),i=n+2;yield{beforeCode:o.substring(0,t),code:e},o=o.substring(i)}}(n);let{value:i,done:r}=o.next();for(r||(e.textContent="");!r&&i;){const n=i.code,s=t(n);e.textContent+=i.beforeCode+s,({value:i,done:r}=o.next())}}for(const t of e.childNodes)t.nodeType===Node.TEXT_NODE&&n(t)})(t,(t=>this.runExpressionCode(e,t)));for(const[n,o]of this.directiveMap)if(o.updated){if(!n.multi){const[i,r]=[t.getAttributeNode(n.name),n.aliasName?t.getAttributeNode(n.aliasName):void 0];if(!i&&!r)continue;i&&void 0!==i.value&&null!==i.value?o.updated(t,i,e):r&&void 0!==r.value&&null!==r.value&&o.updated(t,r,e)}for(const i of t.attributes)i.name.startsWith(n.name)&&(n.aliasName&&!i.name.startsWith(n.aliasName)||o.updated&&o.updated.bind(this)(t,i,e))}return e.domElement=t,e.domElement}}},156:function(e,t,n){var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,i)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||o(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0});const r=n(132);i(n(132),t),t.default=r.EUV},746:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.escapeRegExp=void 0,t.escapeRegExp=function(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}}},t={},n=function n(o){var i=t[o];if(void 0!==i)return i.exports;var r=t[o]={exports:{}};return e[o].call(r.exports,r,r.exports,n),r.exports}(156),o=self;for(var i in n)o[i]=n[i];n.__esModule&&Object.defineProperty(o,"__esModule",{value:!0})})();