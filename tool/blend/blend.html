<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>å¯è‡ªå®šä¹‰å›¾ç‰‡çš„å¤šå±‚å åŠ æ–‡å­—å¢å¼ºå·¥å…·</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      }

      body {
        background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d);
        color: #333;
        line-height: 1.6;
        min-height: 100vh;
        padding: 20px;
      }

      .container {
        max-width: 1400px;
        margin: 0 auto;
      }

      header {
        text-align: center;
        margin-bottom: 30px;
        padding: 20px;
        background: rgba(255, 255, 255, 0.9);
        border-radius: 15px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
      }

      h1 {
        color: #2c3e50;
        margin-bottom: 10px;
        font-size: 2.8rem;
        background: linear-gradient(45deg, #1a2a6c, #b21f1f);
        -webkit-background-clip: text;
        background-clip: text;
        color: transparent;
      }

      ul {
        padding-left: 2em;
      }

      .subtitle {
        color: #7f8c8d;
        font-size: 1.2rem;
        max-width: 800px;
        margin: 0 auto;
      }

      .upload-section {
        background: rgba(255, 255, 255, 0.9);
        padding: 25px;
        border-radius: 15px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        margin-bottom: 30px;
      }

      .upload-section h2 {
        color: #2c3e50;
        margin-bottom: 20px;
        padding-bottom: 10px;
        border-bottom: 2px solid #3498db;
      }

      .upload-options {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
      }

      @media (max-width: 768px) {
        .upload-options {
          grid-template-columns: 1fr;
        }
      }

      .upload-option {
        background: #f8f9fa;
        padding: 20px;
        border-radius: 10px;
        border: 2px dashed #ced4da;
      }

      .upload-option h3 {
        color: #2c3e50;
        margin-bottom: 15px;
        display: flex;
        align-items: center;
      }

      .upload-option h3 i {
        margin-right: 10px;
        color: #3498db;
      }

      .file-upload {
        position: relative;
        margin-bottom: 15px;
      }

      .file-upload input {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        opacity: 0;
        cursor: pointer;
      }

      .file-upload-label {
        display: block;
        padding: 15px;
        background: #3498db;
        color: white;
        text-align: center;
        border-radius: 5px;
        cursor: pointer;
        transition: background 0.3s;
      }

      .file-upload-label:hover {
        background: #2980b9;
      }

      .url-upload {
        display: flex;
        gap: 10px;
      }

      .url-upload input {
        flex: 1;
        padding: 12px;
        border: 1px solid #ced4da;
        border-radius: 5px;
      }

      .url-upload button {
        padding: 12px 20px;
        background: #2ecc71;
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        transition: background 0.3s;
      }

      .url-upload button:hover {
        background: #27ae60;
      }

      .sample-images {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
        gap: 15px;
        margin-top: 20px;
      }

      .sample-image {
        border-radius: 8px;
        overflow: hidden;
        cursor: pointer;
        transition: transform 0.3s;
        box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
      }

      .sample-image:hover {
        transform: scale(1.05);
      }

      .sample-image img {
        width: 100%;
        height: 100px;
        object-fit: cover;
        display: block;
      }

      .content {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 30px;
        margin-bottom: 40px;
      }

      @media (max-width: 1100px) {
        .content {
          grid-template-columns: 1fr;
        }
      }

      .image-box {
        background: rgba(255, 255, 255, 0.9);
        padding: 20px;
        border-radius: 15px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
      }

      .image-box h2 {
        color: #2c3e50;
        margin-bottom: 15px;
        padding-bottom: 10px;
        border-bottom: 2px solid #3498db;
      }

      .image-container {
        position: relative;
        border-radius: 10px;
        overflow: hidden;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        height: 400px;
        margin-bottom: 15px;
        background: #f8f9fa;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .image-container.placeholder::before {
        content: "è¯·ä¸Šä¼ å›¾ç‰‡æˆ–é€‰æ‹©ç¤ºä¾‹å›¾ç‰‡";
        color: #6c757d;
        font-size: 1.2rem;
      }

      .original-image,
      .enhanced-image {
        width: 100%;
        height: 100%;
        object-fit: contain;
        display: block;
      }

      .enhanced-container {
        position: relative;
        width: 100%;
        height: 100%;
      }

      .layer {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
      }

      .controls {
        background: rgba(255, 255, 255, 0.9);
        padding: 25px;
        border-radius: 15px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        margin-bottom: 30px;
      }

      .control-section {
        margin-bottom: 25px;
        padding-bottom: 20px;
        border-bottom: 1px solid #eee;
      }

      .control-section h3 {
        color: #2c3e50;
        margin-bottom: 15px;
        display: flex;
        align-items: center;
      }

      .control-section h3 i {
        margin-right: 10px;
        color: #3498db;
      }

      .layers-control {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 20px;
      }

      .layer-control {
        background: #f8f9fa;
        padding: 15px;
        border-radius: 10px;
        border: 1px solid #e9ecef;
      }

      .layer-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 10px;
      }

      .layer-title {
        font-weight: bold;
        color: #2c3e50;
      }

      .remove-layer {
        background: #e74c3c;
        color: white;
        border: none;
        border-radius: 4px;
        padding: 4px 8px;
        cursor: pointer;
        font-size: 0.8rem;
      }

      .control-group {
        margin-bottom: 15px;
      }

      label {
        display: block;
        margin-bottom: 5px;
        font-weight: 600;
        color: #495057;
      }

      select,
      input {
        width: 100%;
        padding: 8px 12px;
        border: 1px solid #ced4da;
        border-radius: 5px;
        font-size: 1rem;
      }

      .slider-container {
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .slider-value {
        min-width: 40px;
        text-align: center;
        font-weight: bold;
        color: #3498db;
      }

      .buttons {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
      }

      button {
        padding: 10px 20px;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        font-weight: 600;
        transition: all 0.3s ease;
      }

      .btn-primary {
        background: #3498db;
        color: white;
      }

      .btn-success {
        background: #2ecc71;
        color: white;
      }

      .btn-danger {
        background: #e74c3c;
        color: white;
      }

      button:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      }

      .presets {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
        gap: 15px;
      }

      .preset {
        background: #f8f9fa;
        padding: 15px;
        border-radius: 8px;
        text-align: center;
        cursor: pointer;
        border: 2px solid transparent;
        transition: all 0.3s ease;
      }

      .preset:hover {
        border-color: #3498db;
        transform: translateY(-3px);
      }

      .preset.active {
        border-color: #2ecc71;
        background: #e8f6f3;
      }

      .explanation {
        background: rgba(255, 255, 255, 0.9);
        padding: 25px;
        border-radius: 15px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
      }

      .explanation h2 {
        color: #2c3e50;
        margin-bottom: 20px;
        padding-bottom: 10px;
        border-bottom: 2px solid #3498db;
      }

      .explanation p {
        margin-bottom: 15px;
      }

      .tips {
        background: #e8f4fc;
        padding: 20px;
        border-radius: 10px;
        border-left: 5px solid #3498db;
        margin-top: 20px;
      }

      .tips h3 {
        color: #2980b9;
        margin-bottom: 10px;
      }

      .mode-info {
        display: inline-block;
        background: #3498db;
        color: white;
        padding: 3px 10px;
        border-radius: 4px;
        font-size: 0.9rem;
        margin: 0 5px;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <header>
        <h1>å¯è‡ªå®šä¹‰å›¾ç‰‡çš„å¤šå±‚å åŠ æ–‡å­—å¢å¼ºå·¥å…·</h1>
        <p class="subtitle">
          ä¸Šä¼ æ‚¨çš„å›¾ç‰‡ï¼Œä½¿ç”¨CSS
          mix-blend-modeä¸å¤šå±‚å åŠ æŠ€æœ¯å¢å¼ºå›¾ç‰‡ä¸­é»‘è‰²æ–‡å­—çš„å¯è¯»æ€§
        </p>
      </header>

      <div class="upload-section">
        <h2>ä¸Šä¼ å›¾ç‰‡</h2>
        <div class="upload-options">
          <div class="upload-option">
            <h3><i>ğŸ“</i> ä»æœ¬åœ°ä¸Šä¼ </h3>
            <div class="file-upload">
              <input type="file" id="fileInput" accept="image/*" />
              <label for="fileInput" class="file-upload-label"
                >é€‰æ‹©å›¾ç‰‡æ–‡ä»¶</label
              >
            </div>
            <p>æ”¯æŒ JPGã€PNGã€GIF æ ¼å¼</p>
          </div>

          <div class="upload-option">
            <h3><i>ğŸ”—</i> ä»ç½‘ç»œåŠ è½½</h3>
            <div class="url-upload">
              <input type="url" id="urlInput" placeholder="è¾“å…¥å›¾ç‰‡URL" />
              <button id="loadUrlBtn">åŠ è½½å›¾ç‰‡</button>
            </div>
            <p>è¾“å…¥æœ‰æ•ˆçš„å›¾ç‰‡URLåœ°å€</p>
          </div>
        </div>

        <h3 style="margin-top: 20px">æˆ–é€‰æ‹©ç¤ºä¾‹å›¾ç‰‡ï¼š</h3>
        <div class="sample-images">
          <div
            class="sample-image"
            data-url="https://picsum.photos/600?random=1"
          >
            <img src="https://picsum.photos/600?random=1" alt="ç¤ºä¾‹1" />
          </div>
          <div
            class="sample-image"
            data-url="https://picsum.photos/600?random=2"
          >
            <img src="https://picsum.photos/600?random=2" alt="ç¤ºä¾‹2" />
          </div>
          <div
            class="sample-image"
            data-url="https://picsum.photos/600?random=3"
          >
            <img src="https://picsum.photos/600?random=3" alt="ç¤ºä¾‹3" />
          </div>
          <div
            class="sample-image"
            data-url="https://picsum.photos/600?random=4"
          >
            <img src="https://picsum.photos/600?random=4" alt="ç¤ºä¾‹4" />
          </div>
        </div>
      </div>

      <div class="content">
        <div class="image-box">
          <h2>åŸå§‹å›¾ç‰‡</h2>
          <div class="image-container placeholder" id="originalContainer">
            <!-- å›¾ç‰‡å°†é€šè¿‡JavaScriptåŠ¨æ€åŠ è½½ -->
          </div>
          <p>åŸå§‹å›¾ç‰‡åŒ…å«é»‘è‰²æ–‡å­—å’Œå¤æ‚èƒŒæ™¯ï¼Œæ–‡å­—å¯è¯»æ€§è¾ƒå·®ã€‚</p>
        </div>

        <div class="image-box">
          <h2>å¢å¼ºæ•ˆæœ</h2>
          <div class="image-container placeholder" id="enhancedContainer">
            <div class="enhanced-container">
              <!-- å›¾ç‰‡å’Œå›¾å±‚å°†é€šè¿‡JavaScriptåŠ¨æ€åŠ è½½ -->
            </div>
          </div>
          <p>åº”ç”¨å¤šå±‚å åŠ æ•ˆæœåï¼Œé»‘è‰²æ–‡å­—æ›´åŠ æ¸…æ™°ï¼ŒèƒŒæ™¯å¹²æ‰°å‡å°‘ã€‚</p>
        </div>
      </div>

      <div class="controls">
        <div class="control-section">
          <h3><i>â•</i> å›¾å±‚æ§åˆ¶</h3>
          <div class="layers-control" id="layersControl">
            <!-- å›¾å±‚æ§åˆ¶å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
          </div>
          <div class="buttons" style="margin-top: 15px">
            <button class="btn-success" id="addLayerBtn">æ·»åŠ æ–°å›¾å±‚</button>
            <button class="btn-danger" id="resetLayersBtn">é‡ç½®æ‰€æœ‰å›¾å±‚</button>
          </div>
        </div>

        <div class="control-section">
          <h3><i>âš¡</i> é¢„è®¾æ•ˆæœ</h3>
          <div class="presets" id="presets">
            <div class="preset" data-preset="difference">å·®å¼‚æ¨¡å¼å¢å¼º</div>
            <div class="preset" data-preset="multiply">æ­£ç‰‡å åº•å¢å¼º</div>
            <div class="preset" data-preset="screen">æ»¤è‰²æ¨¡å¼å¢å¼º</div>
            <div class="preset" data-preset="overlay">å åŠ æ¨¡å¼å¢å¼º</div>
            <div class="preset active" data-preset="custom">è‡ªå®šä¹‰å¤šå±‚</div>
          </div>
        </div>
      </div>

      <div class="explanation">
        <h2>æŠ€æœ¯åŸç†</h2>
        <p>
          è¿™ä¸ªå·¥å…·ä½¿ç”¨CSSçš„<code>mix-blend-mode</code>å±æ€§åˆ›å»ºå¤šå±‚å åŠ æ•ˆæœï¼Œä»¥å¢å¼ºå›¾ç‰‡ä¸­é»‘è‰²æ–‡å­—çš„å¯è¯»æ€§ã€‚
        </p>

        <p>
          <span class="mode-info">mix-blend-mode</span
          >å±æ€§å®šä¹‰äº†å…ƒç´ å†…å®¹åº”å¦‚ä½•ä¸å…¶çˆ¶å…ƒç´ å’ŒèƒŒæ™¯æ··åˆã€‚
        </p>

        <p>é€šè¿‡å åŠ å¤šä¸ªå…·æœ‰ä¸åŒæ··åˆæ¨¡å¼å’Œé¢œè‰²çš„å›¾å±‚ï¼Œæˆ‘ä»¬å¯ä»¥ï¼š</p>
        <ul>
          <li>å¢å¼ºæ–‡å­—ä¸èƒŒæ™¯çš„å¯¹æ¯”åº¦</li>
          <li>å‡å°‘èƒŒæ™¯å›¾æ¡ˆå¯¹æ–‡å­—çš„å¹²æ‰°</li>
          <li>çªå‡ºæ˜¾ç¤ºæ–‡å­—å†…å®¹</li>
          <li>åˆ›å»ºè‡ªå®šä¹‰çš„è§†è§‰æ•ˆæœ</li>
        </ul>

        <div class="tips">
          <h3>ä½¿ç”¨æŠ€å·§</h3>
          <p>
            1.
            å¯¹äºé»‘è‰²æ–‡å­—ï¼Œå°è¯•ä½¿ç”¨<strong>difference</strong>æ¨¡å¼é…åˆç™½è‰²å åŠ å±‚ã€‚
          </p>
          <p>2. æ·»åŠ å¤šä¸ªå›¾å±‚å¯ä»¥åˆ›å»ºæ›´å¤æ‚çš„æ•ˆæœï¼Œä½†è¦æ³¨æ„æ€§èƒ½å½±å“ã€‚</p>
          <p>3. ä½¿ç”¨è¾ƒä½çš„ä¸é€æ˜åº¦å¯ä»¥åˆ›å»ºæ›´å¾®å¦™çš„æ•ˆæœã€‚</p>
          <p>4. å°è¯•ä¸åŒçš„é¢œè‰²ç»„åˆï¼Œæ‰¾åˆ°æœ€é€‚åˆæ‚¨å›¾åƒçš„æ•ˆæœã€‚</p>
        </div>
      </div>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        // åˆå§‹å›¾å±‚é…ç½®
        let layers = [
          {
            id: "layer1",
            blendMode: "difference",
            color: "#ffffff",
            opacity: 70,
            visible: true,
          },
          {
            id: "layer2",
            blendMode: "overlay",
            color: "#000000",
            opacity: 20,
            visible: true,
          },
        ];

        // DOMå…ƒç´ 
        const fileInput = document.getElementById("fileInput");
        const urlInput = document.getElementById("urlInput");
        const loadUrlBtn = document.getElementById("loadUrlBtn");
        const sampleImages = document.querySelectorAll(".sample-image");
        const originalContainer = document.getElementById("originalContainer");
        const enhancedContainer = document.getElementById("enhancedContainer");
        const layersControl = document.getElementById("layersControl");
        const addLayerBtn = document.getElementById("addLayerBtn");
        const resetLayersBtn = document.getElementById("resetLayersBtn");
        const presets = document.getElementById("presets");

        // å½“å‰å›¾ç‰‡URL
        let currentImageUrl =
          "https://images.unsplash.com/photo-1586075010923-2dd4570fb338?ixlib=rb-1.2.1&auto=format&fit=crop&w=600&q=80";

        // åˆå§‹åŒ–
        loadImage(currentImageUrl);
        renderLayers();

        // æ–‡ä»¶ä¸Šä¼ äº‹ä»¶
        fileInput.addEventListener("change", function (e) {
          const file = e.target.files[0];
          if (file) {
            const reader = new FileReader();
            reader.onload = function (event) {
              currentImageUrl = event.target.result;
              loadImage(currentImageUrl);
            };
            reader.readAsDataURL(file);
          }
        });

        // URLåŠ è½½äº‹ä»¶
        loadUrlBtn.addEventListener("click", function () {
          const url = urlInput.value.trim();
          if (url) {
            currentImageUrl = url;
            loadImage(currentImageUrl);
          } else {
            alert("è¯·è¾“å…¥æœ‰æ•ˆçš„å›¾ç‰‡URL");
          }
        });

        // ç¤ºä¾‹å›¾ç‰‡ç‚¹å‡»äº‹ä»¶
        sampleImages.forEach((sample) => {
          sample.addEventListener("click", function () {
            currentImageUrl = this.dataset.url;
            loadImage(currentImageUrl);
          });
        });

        // åŠ è½½å›¾ç‰‡å‡½æ•°
        function loadImage(url) {
          const img = new Image();
          img.onload = function () {
            // æ›´æ–°åŸå§‹å›¾ç‰‡å®¹å™¨
            originalContainer.innerHTML = "";
            originalContainer.classList.remove("placeholder");
            const originalImg = document.createElement("img");
            originalImg.src = url;
            originalImg.className = "original-image";
            originalContainer.appendChild(originalImg);

            // æ›´æ–°å¢å¼ºå›¾ç‰‡å®¹å™¨
            enhancedContainer.innerHTML = "";
            enhancedContainer.classList.remove("placeholder");
            const enhancedImgContainer = document.createElement("div");
            enhancedImgContainer.className = "enhanced-container";

            const enhancedImg = document.createElement("img");
            enhancedImg.src = url;
            enhancedImg.className = "enhanced-image";
            enhancedImgContainer.appendChild(enhancedImg);

            // æ·»åŠ å›¾å±‚
            layers.forEach((layer) => {
              const layerElement = document.createElement("div");
              layerElement.id = layer.id;
              layerElement.className = "layer";
              layerElement.style.mixBlendMode = layer.blendMode;
              layerElement.style.backgroundColor = layer.color;
              layerElement.style.opacity = layer.visible
                ? layer.opacity / 100
                : 0;
              enhancedImgContainer.appendChild(layerElement);
            });

            enhancedContainer.appendChild(enhancedImgContainer);
          };

          img.onerror = function () {
            alert("å›¾ç‰‡åŠ è½½å¤±è´¥ï¼Œè¯·æ£€æŸ¥URLæ˜¯å¦æ­£ç¡®æˆ–å°è¯•å…¶ä»–å›¾ç‰‡");
          };

          img.src = url;
        }

        // æ·»åŠ æ–°å›¾å±‚
        addLayerBtn.addEventListener("click", function () {
          const newId = "layer" + (layers.length + 1);
          layers.push({
            id: newId,
            blendMode: "difference",
            color: "#ffffff",
            opacity: 50,
            visible: true,
          });
          renderLayers();
          updateEnhancedImage();
        });

        // é‡ç½®æ‰€æœ‰å›¾å±‚
        resetLayersBtn.addEventListener("click", function () {
          layers = [
            {
              id: "layer1",
              blendMode: "difference",
              color: "#ffffff",
              opacity: 70,
              visible: true,
            },
          ];
          renderLayers();
          updateEnhancedImage();
        });

        // é¢„è®¾æ•ˆæœ
        presets.addEventListener("click", function (e) {
          if (e.target.classList.contains("preset")) {
            // ç§»é™¤æ‰€æœ‰activeç±»
            document
              .querySelectorAll(".preset")
              .forEach((p) => p.classList.remove("active"));
            // æ·»åŠ activeç±»åˆ°å½“å‰ç‚¹å‡»çš„é¢„è®¾
            e.target.classList.add("active");

            const preset = e.target.dataset.preset;
            applyPreset(preset);
          }
        });

        // æ¸²æŸ“å›¾å±‚æ§åˆ¶
        function renderLayers() {
          layersControl.innerHTML = "";

          layers.forEach((layer, index) => {
            const layerControl = document.createElement("div");
            layerControl.className = "layer-control";
            layerControl.innerHTML = `
                        <div class="layer-header">
                            <span class="layer-title">${layer.id}</span>
                            ${index > 0 ? '<button class="remove-layer" data-id="' + layer.id + '">ç§»é™¤</button>' : ""}
                        </div>
                        <div class="control-group">
                            <label>æ··åˆæ¨¡å¼</label>
                            <select class="blend-mode" data-id="${layer.id}">
                                <option value="normal">normal - æ­£å¸¸</option>
                                <option value="multiply">multiply - æ­£ç‰‡å åº•</option>
                                <option value="screen">screen - æ»¤è‰²</option>
                                <option value="overlay">overlay - å åŠ </option>
                                <option value="darken">darken - å˜æš—</option>
                                <option value="lighten">lighten - å˜äº®</option>
                                <option value="color-dodge">color-dodge - é¢œè‰²å‡æ·¡</option>
                                <option value="color-burn">color-burn - é¢œè‰²åŠ æ·±</option>
                                <option value="hard-light">hard-light - å¼ºå…‰</option>
                                <option value="soft-light">soft-light - æŸ”å…‰</option>
                                <option value="difference">difference - å·®å¼‚</option>
                                <option value="exclusion">exclusion - æ’é™¤</option>
                            </select>
                        </div>
                        <div class="control-group">
                            <label>é¢œè‰²</label>
                            <input type="color" class="layer-color" data-id="${layer.id}" value="${layer.color}">
                        </div>
                        <div class="control-group">
                            <label>ä¸é€æ˜åº¦</label>
                            <div class="slider-container">
                                <input type="range" class="layer-opacity" data-id="${layer.id}" min="0" max="100" value="${layer.opacity}">
                                <span class="slider-value">${layer.opacity}%</span>
                            </div>
                        </div>
                        <div class="control-group">
                            <label>
                                <input type="checkbox" class="layer-visible" data-id="${layer.id}" ${layer.visible ? "checked" : ""}>
                                å¯è§
                            </label>
                        </div>
                    `;

            layersControl.appendChild(layerControl);

            // è®¾ç½®å½“å‰å€¼
            const blendModeSelect = layerControl.querySelector(".blend-mode");
            blendModeSelect.value = layer.blendMode;

            // æ·»åŠ äº‹ä»¶ç›‘å¬
            blendModeSelect.addEventListener("change", function () {
              updateLayerProperty(this.dataset.id, "blendMode", this.value);
            });

            const colorInput = layerControl.querySelector(".layer-color");
            colorInput.addEventListener("input", function () {
              updateLayerProperty(this.dataset.id, "color", this.value);
            });

            const opacityInput = layerControl.querySelector(".layer-opacity");
            opacityInput.addEventListener("input", function () {
              const value = this.value;
              this.nextElementSibling.textContent = value + "%";
              updateLayerProperty(this.dataset.id, "opacity", parseInt(value));
            });

            const visibleInput = layerControl.querySelector(".layer-visible");
            visibleInput.addEventListener("change", function () {
              updateLayerProperty(this.dataset.id, "visible", this.checked);
            });

            const removeBtn = layerControl.querySelector(".remove-layer");
            if (removeBtn) {
              removeBtn.addEventListener("click", function () {
                layers = layers.filter((l) => l.id !== this.dataset.id);
                renderLayers();
                updateEnhancedImage();
              });
            }
          });
        }

        // æ›´æ–°å›¾å±‚å±æ€§
        function updateLayerProperty(layerId, property, value) {
          const layer = layers.find((l) => l.id === layerId);
          if (layer) {
            layer[property] = value;
            updateEnhancedImage();
          }
        }

        // æ›´æ–°å¢å¼ºå›¾åƒ
        function updateEnhancedImage() {
          layers.forEach((layer) => {
            const layerElement = document.getElementById(layer.id);
            if (layerElement) {
              layerElement.style.mixBlendMode = layer.blendMode;
              layerElement.style.backgroundColor = layer.color;
              layerElement.style.opacity = layer.visible
                ? layer.opacity / 100
                : 0;
            }
          });
        }

        // åº”ç”¨é¢„è®¾
        function applyPreset(preset) {
          switch (preset) {
            case "difference":
              layers = [
                {
                  id: "layer1",
                  blendMode: "difference",
                  color: "#ffffff",
                  opacity: 70,
                  visible: true,
                },
              ];
              break;
            case "multiply":
              layers = [
                {
                  id: "layer1",
                  blendMode: "multiply",
                  color: "#ffffff",
                  opacity: 50,
                  visible: true,
                },
              ];
              break;
            case "screen":
              layers = [
                {
                  id: "layer1",
                  blendMode: "screen",
                  color: "#000000",
                  opacity: 50,
                  visible: true,
                },
              ];
              break;
            case "overlay":
              layers = [
                {
                  id: "layer1",
                  blendMode: "overlay",
                  color: "#ffffff",
                  opacity: 60,
                  visible: true,
                },
                {
                  id: "layer2",
                  blendMode: "overlay",
                  color: "#000000",
                  opacity: 30,
                  visible: true,
                },
              ];
              break;
            case "custom":
              // ä¿æŒå½“å‰è‡ªå®šä¹‰è®¾ç½®
              return;
          }

          renderLayers();
          updateEnhancedImage();
        }
      });
    </script>
  </body>
</html>
